<!DOCTYPE html>
<html lang="en">
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Fractal Porn</title>
	<link href="styles.css" rel="stylesheet" />
  <style>
    /* Rainbow gradient text effect */
    .rainbow {
      background: linear-gradient(90deg, #ff0040, #ff8a00, #ffd500, #21d19f, #00a3ff, #8a2be2, #ff0040);
      background-size: 400% 100%;
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      animation: rainbowShift 3s linear infinite;
    }
    @media (prefers-reduced-motion: reduce) {
      .rainbow { animation: none; }
    }
    @keyframes rainbowShift {
      0% { background-position: 0% 50%; }
      100% { background-position: 100% 50%; }
    }
  </style>
</head>
<body>
<a class="skip-link" href="#main">Skip to content</a>
<header data-include="partials/header.html"></header>
<main id="main">
  <h1 align="center" style="margin-top: 20vh; font-size: 3em;">
    4Ö4 – f0ur, 0h FOUR!!
  </h1>

  <p id="glitchText" align="center" style="font-size: 1.3em; margin: 1em 10%;">
    ¡t &lt;3r+4¡n1y seems the requested page does not exist. Or at least not anymore. 0r m4yb3 N0T y3t …? 0r m4yb3 n0t 4 u?
  </p>
</main>
  <script>
    // Tuned glitch text: readable cadence, no overlap, reduced CPU, respects reduced motion
    const element = document.getElementById("glitchText");

    const variants = [
      { text: "It <3r+4in1y 533M5 the re3qu35+5+3D P463 D035 N0+ 3xI5T. 0r at least not anymore. 0r m4yb3 N0T y3t …? 0r m4yb3 n0t f0r y0u?", weight: 10 },
      { text: "☠ ERROR 404 ☠   This dimension does not contain what you seek …", weight: 10 },
      { text: "Signal Lost. Transmission scrambled beyond retrieval.", weight: 10 },
      { text: "[404.C0DEX]: target.page = undefined; retry ⇨∞", weight: 10 },
      { text: "I can't lie to you about your chances, but … you have my sympathies. :)", weight: 10 },
      { text: "¯\\_(ツ)_/¯  There's nothing here. Or is there?", weight: 10 },
      { text: "void ∞ echo(‘meaningless request’); // try again later", weight: 10 },
      { text: "Gordon doesn't need to hear all this, he's a highly-trained professional.", weight: 10 }
    ];

    // Use whatever the page initially shows as the canonical baseline text
    const original = element.textContent;

    const config = {
      // How long a glitch stays before returning to the original text
      // alt text visible between 50ms and 2000ms
      glitchDurationMs: [50, 2000],
      // How long to wait between glitches (original text visible)
      // original visible between 1000ms (1s) and 13000ms (13s)
      idleIntervalMs: [1000, 13000],
      // If user prefers reduced motion, bias durations upward but clamp to the above bounds
      reducedMotionFactor: 2.5,
      // Chance that a glitch chains into another glitch instead of reverting immediately
      chainChance: 0.10,
      // After two glitches in a row, small chance to show a third
      chainChanceAfterTwo: 0.01,
      // Chance that any shown text (original or glitch) appears with rainbow colours
      rainbowChance: 0.05
    };

    function pickInRange([min, max]) {
      return Math.floor(min + Math.random() * (max - min));
    }

    function getWeightedRandomVariant() {
      const totalWeight = variants.reduce((sum, v) => sum + v.weight, 0);
      let rand = Math.random() * totalWeight;
      for (const v of variants) {
        if (rand < v.weight) return v.text;
        rand -= v.weight;
      }
      return variants[0].text; // fallback
    }

    function setText(s) {
      element.textContent = s;
      // Randomly apply rainbow style
      element.classList.remove('rainbow');
      if (Math.random() < config.rainbowChance) {
        element.classList.add('rainbow');
      }
    }

    const prefersReducedMotion = window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches;

    let timer = null;

    function glitchOnceThenMaybeChain(chainCount = 0) {
      const glitchText = getWeightedRandomVariant();
      setText(glitchText);

      const baseDuration = pickInRange(config.glitchDurationMs);
      const duration = prefersReducedMotion
        ? Math.min(config.glitchDurationMs[1], Math.max(config.glitchDurationMs[0], Math.round(baseDuration * config.reducedMotionFactor)))
        : baseDuration;

      setTimeout(() => {
        // Determine probability based on how many glitches have already been shown in this chain
        const probability = chainCount === 0
          ? config.chainChance
          : (chainCount === 1 ? (config.chainChanceAfterTwo || 0) : 0);

        if (Math.random() < probability) {
          // Show another glitch immediately (no original in between)
          glitchOnceThenMaybeChain(chainCount + 1);
        } else {
          setText(original);
          scheduleNext();
        }
      }, duration);
    }

    function scheduleNext() {
      const baseIdle = pickInRange(config.idleIntervalMs);
      const idle = prefersReducedMotion
        ? Math.min(config.idleIntervalMs[1], Math.max(config.idleIntervalMs[0], Math.round(baseIdle * config.reducedMotionFactor)))
        : baseIdle;

      timer = setTimeout(() => {
        glitchOnceThenMaybeChain(0);
      }, idle);
    }

    // kick it off
    scheduleNext();
  </script>

<footer data-include="partials/footer.html"></footer>
<script src="partials/includes.js"></script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Fractal Porn</title>
	<link href="styles.css" rel="stylesheet" />
	<meta name="ocs-site-verification" content="965be62463731b0314eea395abb46994" />
</head>
<body>
<a class="skip-link" href="#main">Skip to content</a>
<header data-include="partials/header.html"></header>

<main id="main">
<section class="hero">
<h2>4O4</h2>

<p>Explore the nothing …</p>

<a class="btn" href="./gallery.html">View Gallery</a></section>
´
</main>

<footer data-include="partials/footer.html"></footer>

<div class="modal" id="imageModal" role="dialog" aria-modal="true" aria-label="Image viewer"><span class="close-btn" role="button" aria-label="Close" tabindex="0"><s>&times;</s></span>

<div class="modal-content"><img alt="" class="modal-img" src="" /></div>
</div>
<script src="partials/includes.js"></script>
<script>
        const modal = document.getElementById('imageModal');
        const modalImg = document.querySelector('.modal-img');
        const closeBtn = document.querySelector('.close-btn');
        const galleryImages = document.querySelectorAll('.image-container img');

        galleryImages.forEach(img => {
            img.addEventListener('click', () => {
                modal.style.display = 'block';
                modalImg.src = img.src;
                modalImg.alt = img.alt;
            });
        });

        function closeModal() {
            modal.style.display = 'none';
        }

        closeBtn.addEventListener('click', closeModal);
        closeBtn.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                closeModal();
            }
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeModal();
            }
        });

        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                closeModal();
            }
        });
    </script></body>
</html>
